# Swaps Analysis Tool - Product Requirements Document

## 1. Overview
A lightweight desktop application for downloading, parsing, and analyzing swaps data to identify obligations and risks associated with financial securities.

## 2. Core Functionality

### 2.1 Data Ingestion
- Download swaps data from SEC EDGAR system
- Support for multiple file formats (XML, JSON, CSV)
- Scheduled and on-demand data refreshes

### 2.2 Data Processing
- Parse swaps data into structured format
- Extract key entities (counterparties, reference securities, terms)
- Normalize data for analysis

### 2.3 Database Schema (SQLite)
```
Tables:
1. swaps
   - id (PK)
   - trade_id (unique identifier)
   - trade_date
   - effective_date
   - maturity_date
   - notional_amount
   - currency
   - swap_type
   - raw_data (JSON)

2. counterparties
   - id (PK)
   - lei (Legal Entity Identifier)
   - name
   - entity_type

3. reference_securities
   - id (PK)
   - security_type (e.g., BOND, STOCK)
   - identifier_type (CUSIP, ISIN, etc.)
   - identifier_value
   - description

4. swap_obligations
   - id (PK)
   - swap_id (FK to swaps)
   - obligation_type (e.g., payment, collateral)
   - amount
   - currency
   - due_date
   - status

5. swap_analysis
   - id (PK)
   - swap_id (FK to swaps)
   - analysis_text (generated by Ollama)
   - risk_score
   - key_risks (JSON)
   - created_at
```

### 2.4 Analysis Engine
- Correlate swaps with underlying securities
- Calculate exposure metrics
- Generate risk assessments
- Identify concentration risks

### 2.5 AI Integration (Ollama)
- Explain swap structures in plain language
- Highlight key risks and triggers
- Provide scenario analysis
- Generate executive summaries

## 3. Technical Requirements

### 3.1 Technology Stack
- **Backend**: Python 3.9+
- **Database**: SQLite with SQLAlchemy ORM
- **AI**: Ollama for natural language analysis
- **Dependencies**: 
  - `sqlalchemy` for database operations
  - `pandas` for data manipulation
  - `requests` for API calls
  - `python-dotenv` for configuration

### 3.2 Performance
- Process 10,000+ swaps efficiently
- Sub-second response time for common queries
- Minimal memory footprint

## 4. User Interface

### 4.1 Command Line Interface
- Interactive menu system
- Search functionality
- Report generation
- Data export options

### 4.2 Key Commands
```
$ swaps-cli download [--source=SEC] [--date=YYYY-MM-DD]
$ swaps-cli analyze [--security=IDENTIFIER] [--counterparty=LEI]
$ swaps-cli report [--type=exposure|risk|summary]
$ swaps-cli explain [swap_id]
```

## 5. Security
- Encrypt sensitive data at rest
- Secure API key management
- Input validation and sanitization
- Audit logging of all operations

## 6. Development Phases

### Phase 1: Core Infrastructure (2 weeks)
- Set up database schema
- Implement data ingestion pipeline
- Basic CLI interface

### Phase 2: Analysis Engine (3 weeks)
- Implement correlation logic
- Risk calculation framework
- Basic reporting

### Phase 3: AI Integration (2 weeks)
- Ollama integration
- Natural language analysis
- Executive summaries

### Phase 4: Polish & Documentation (1 week)
- Error handling
- Performance optimization
- User documentation

## 7. Future Enhancements
- Web-based dashboard
- Real-time monitoring
- Advanced analytics
- Regulatory reporting templates

## 8. Success Metrics
- Data processing time < 5 minutes per 10,000 swaps
- 99.9% data accuracy
- User satisfaction > 4.5/5
- Mean time to generate reports < 10 seconds
